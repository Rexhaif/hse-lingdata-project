---
title: "Essay analysis"
output: html_notebook
---
Here we will perform analysis of LIWC data of essays, written by different groups of people.

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggpubr)
```

First, let's load the data. Concatenated dataset is in ```all_groups.csv```

```{r}
data <- read.csv("./all_groups.csv")
data[data == 0] <- NA
head(data)
```
This is concatenation of LIWC analysis using LIWC2015 + default russian dictionary. There is a lot of columns representing different word categories, but we only need those related to emotiona expression.

```{r}
needed_columns <- c("Filename", "group", "Позитив", "Негатив", "Беспокойство", "Гнев", "Грусть")
data <- data[, needed_columns]
head(data)
```

Also, let's rename the columns for convenience.
```{r}
columns <- c("file", "group", "Positive", "Negative", "Anxienty", "Anger", "Sadness")
emotion_columns <- c("Positive", "Negative", "Anxienty", "Anger", "Sadness")
colnames(data) <- columns
```

Next, we will perform some exploratory analysis, checking what we are working on.
```{r}
group_by(data, group) %>%
  summarise(
    count = n(),
    across(
      emotion_columns,
      list(
        mean = ~ mean(.x, na.rm = TRUE),
        sd = ~ sd(.x, na.rm = TRUE),
        median = ~ median(.x, na.rm = TRUE)
      )
    )
  )
```
So, in general values have high SD + due to liwc limitations. Let's display the same information in a visual way.
```{r}
for(col in emotion_columns) {
  ggboxplot(
    data, 
    x = "group", y = col, 
    color = "group",
    ylab = col, xlab = "Group"
  )
  ggsave(
    paste("plots/boxplots/", col, ".pdf", sep='')
  )
}
```

We need to examine the distribution of values overall and inside each group. Let's do it by looking at histogram, Q-Q plot + performing Shapiro Wilk's test.
```{r}
for(col in emotion_columns) {
  ggqqplot(
    get(col, data),
    title=paste("Q-Q plot for ", "Positive", sep='')
  )
  ggsave(
    paste("plots/qqplots/", col, ".pdf", sep='')
  )
}
```
Our data partially fits Q-Q plot theoretical part, so it may be normal distribution. But there is also some deviations. Guess we need to look at histograms.

```{r}
for(col in emotion_columns) {
  ggplot(data, aes_string(x=col)) +
    geom_histogram(
      aes(y=..density..),
      position="identity",
      colour="black", fill="white",
      alpha=0.5
    ) +
    geom_density(alpha=0.2, fill="#FF6666")
  ggsave(
    paste("plots/histogram/", col, ".pdf", sep="")
  )
}
```
By looking at histograms, we can say that some of our categories are more likely to be from exponential distribution(Anger, Anxiety, Sadness) and some are more likely ot be from Normal distribution(Positive, Negative).





